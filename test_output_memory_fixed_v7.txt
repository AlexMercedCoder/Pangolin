2025-12-22 19:03:55,766 - INFO - Starting Integration Test for Backend: MemoryStore
2025-12-22 19:03:55,766 - INFO - Creating Tenant: b1c2ab62-021c-4923-8d95-4c20d2a8882c
2025-12-22 19:03:55,775 - INFO - Created Tenant ID: d0ac0968-280f-4e39-87b1-9452ef977f50
2025-12-22 19:03:55,775 - INFO - Creating Tenant Admin User
2025-12-22 19:03:56,695 - INFO - Logging in as Tenant Admin
2025-12-22 19:03:57,603 - INFO - Creating Warehouse with Vending Strategy
2025-12-22 19:03:57,606 - INFO - Creating Catalogs
2025-12-22 19:03:57,613 - INFO - >>> Testing Vended Credentials Catalog (cat_vended)
2025-12-22 19:03:57,645 - INFO - Creating Namespace 'ns1'
2025-12-22 19:03:57,650 - INFO - Creating Table 'ns1.table1'
2025-12-22 19:03:58,999 - INFO - Writing Data to 'ns1.table1'
2025-12-22 19:04:01,312 - INFO - Reading Data from 'ns1.table1'
2025-12-22 19:04:01,365 - INFO - Updating Schema (add column 'ts')
2025-12-22 19:04:01,801 - ERROR - ❌ Vended Credentials Test FAILED: current-schema-id -1 can't be found in the schemas
Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 186, in test_pyiceberg_vended
    with table.update_schema() as update:
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 76, in __exit__
    self.commit()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 72, in commit
    self._transaction._apply(*self._commit())
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 295, in _apply
    self.commit_transaction()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 936, in commit_transaction
    self._table._do_commit(  # pylint: disable=W0212
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 1458, in _do_commit
    response = self.catalog.commit_table(self, requirements, updates)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 731, in commit_table
    return CommitTableResponse.model_validate_json(response.text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pydantic/main.py", line 597, in model_validate_json
    return cls.__pydantic_validator__.validate_json(json_data, strict=strict, context=context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/metadata.py", line 496, in check_schemas
    return check_schemas(table_metadata)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/metadata.py", line 88, in check_schemas
    raise ValidationError(f"current-schema-id {current_schema_id} can't be found in the schemas")
pyiceberg.exceptions.ValidationError: current-schema-id -1 can't be found in the schemas
2025-12-22 19:04:01,805 - INFO - >>> Testing Client Credentials Catalog (cat_client)
2025-12-22 19:04:01,809 - INFO - Creating Namespace 'ns1'
2025-12-22 19:04:01,813 - INFO - Creating Table 'ns1.table1'
2025-12-22 19:04:02,305 - INFO - Writing Data to 'ns1.table1'
2025-12-22 19:04:02,871 - INFO - Reading Data from 'ns1.table1'
2025-12-22 19:04:02,917 - INFO - Updating Schema (add column 'ts')
2025-12-22 19:04:03,006 - ERROR - ❌ Client Credentials Test FAILED: current-schema-id -1 can't be found in the schemas
Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 244, in test_pyiceberg_client
    with table.update_schema() as update:
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 76, in __exit__
    self.commit()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 72, in commit
    self._transaction._apply(*self._commit())
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 295, in _apply
    self.commit_transaction()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 936, in commit_transaction
    self._table._do_commit(  # pylint: disable=W0212
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 1458, in _do_commit
    response = self.catalog.commit_table(self, requirements, updates)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 731, in commit_table
    return CommitTableResponse.model_validate_json(response.text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pydantic/main.py", line 597, in model_validate_json
    return cls.__pydantic_validator__.validate_json(json_data, strict=strict, context=context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/metadata.py", line 496, in check_schemas
    return check_schemas(table_metadata)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/metadata.py", line 88, in check_schemas
    raise ValidationError(f"current-schema-id {current_schema_id} can't be found in the schemas")
pyiceberg.exceptions.ValidationError: current-schema-id -1 can't be found in the schemas
2025-12-22 19:04:03,010 - ERROR - Tests FAILED
