2025-12-22 20:35:08,809 - INFO - Starting Integration Test for Backend: PostgresStore
2025-12-22 20:35:08,809 - INFO - Creating Tenant: b5953780-a694-4127-b1b1-138f54bcc228
2025-12-22 20:35:08,838 - INFO - Created Tenant ID: 49058aa0-4daf-4367-af14-1771b74b6fb3
2025-12-22 20:35:08,838 - INFO - Creating Tenant Admin User
2025-12-22 20:35:09,774 - INFO - Logging in as Tenant Admin
2025-12-22 20:35:10,704 - INFO - Creating Warehouse with Vending Strategy
2025-12-22 20:35:10,725 - INFO - Creating Catalogs
2025-12-22 20:35:10,794 - INFO - >>> Testing Vended Credentials Catalog (cat_vended)
2025-12-22 20:35:10,856 - INFO - Creating Namespace 'ns1'
2025-12-22 20:35:10,886 - INFO - Creating Table 'ns1.table1'
2025-12-22 20:35:11,198 - INFO - Writing Data to 'ns1.table1'
2025-12-22 20:35:11,255 - ERROR - ❌ Vended Credentials Test FAILED: When initiating multiple part upload for key 'cat_vended/ns1/table1/metadata/snap-7355796016810578166-0-286b34fb-d1f3-4c48-9653-cc0a3ef377d6.avro' in bucket 'postgres-bucket': AWS Error INVALID_ACCESS_KEY_ID during CreateMultipartUpload operation: The Access Key Id you provided does not exist in our records.
Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 485, in append
    data_files = list(
                 ^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/io/pyarrow.py", line 2749, in _dataframe_to_data_files
    yield from write_file(
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 619, in result_iterator
    yield _result_or_cancel(fs.pop())
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 317, in _result_or_cancel
    return fut.result(timeout)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/io/pyarrow.py", line 2548, in write_parquet
    with fo.create(overwrite=True) as fos:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/io/pyarrow.py", line 368, in create
    output_file = self._filesystem.open_output_stream(self._path, buffer_size=self._buffer_size)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/_fs.pyx", line 912, in pyarrow._fs.FileSystem.open_output_stream
  File "pyarrow/error.pxi", line 155, in pyarrow.lib.pyarrow_internal_check_status
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
OSError: When initiating multiple part upload for key 'cat_vended/ns1/table1/data/00000-0-286b34fb-d1f3-4c48-9653-cc0a3ef377d6.parquet' in bucket 'postgres-bucket': AWS Error INVALID_ACCESS_KEY_ID during CreateMultipartUpload operation: The Access Key Id you provided does not exist in our records.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 176, in test_pyiceberg_vended
    table.append(df)
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 1362, in append
    tx.append(df=df, snapshot_properties=snapshot_properties, branch=branch)
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 482, in append
    with self._append_snapshot_producer(snapshot_properties, branch=branch) as append_files:
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 76, in __exit__
    self.commit()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 72, in commit
    self._transaction._apply(*self._commit())
                              ^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/snapshot.py", line 277, in _commit
    with write_manifest_list(
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/manifest.py", line 1221, in __enter__
    self._writer.__enter__()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/avro/file.py", line 266, in __enter__
    self.output_stream = self.output_file.create(overwrite=True)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/io/pyarrow.py", line 368, in create
    output_file = self._filesystem.open_output_stream(self._path, buffer_size=self._buffer_size)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/_fs.pyx", line 912, in pyarrow._fs.FileSystem.open_output_stream
  File "pyarrow/error.pxi", line 155, in pyarrow.lib.pyarrow_internal_check_status
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
OSError: When initiating multiple part upload for key 'cat_vended/ns1/table1/metadata/snap-7355796016810578166-0-286b34fb-d1f3-4c48-9653-cc0a3ef377d6.avro' in bucket 'postgres-bucket': AWS Error INVALID_ACCESS_KEY_ID during CreateMultipartUpload operation: The Access Key Id you provided does not exist in our records.
2025-12-22 20:35:11,261 - INFO - >>> Testing Client Credentials Catalog (cat_client)
2025-12-22 20:35:11,264 - INFO - Creating Namespace 'ns1'
2025-12-22 20:35:11,295 - INFO - Creating Table 'ns1.table1'
2025-12-22 20:35:11,753 - INFO - Writing Data to 'ns1.table1'
2025-12-22 20:35:12,457 - INFO - Reading Data from 'ns1.table1'
2025-12-22 20:35:12,507 - INFO - Updating Schema (add column 'ts')
2025-12-22 20:35:13,831 - ERROR - ❌ Client Credentials Test FAILED: RESTError 409: Received unexpected JSON Payload: Failed to commit after retries, errors: Invalid JSON: expected value at line 1 column 1
Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 720, in commit_table
    response.raise_for_status()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 409 Client Error: Conflict for url: http://localhost:8080/v1/cat_client/v1/namespaces/ns1/tables/table1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 244, in test_pyiceberg_client
    with table.update_schema() as update:
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 76, in __exit__
    self.commit()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/update/__init__.py", line 72, in commit
    self._transaction._apply(*self._commit())
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 295, in _apply
    self.commit_transaction()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 936, in commit_transaction
    self._table._do_commit(  # pylint: disable=W0212
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/table/__init__.py", line 1458, in _do_commit
    response = self.catalog.commit_table(self, requirements, updates)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 722, in commit_table
    _handle_non_200_response(
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/response.py", line 111, in _handle_non_200_response
    raise exception(response) from exc
pyiceberg.exceptions.CommitFailedException: RESTError 409: Received unexpected JSON Payload: Failed to commit after retries, errors: Invalid JSON: expected value at line 1 column 1
2025-12-22 20:35:13,835 - ERROR - Tests FAILED
