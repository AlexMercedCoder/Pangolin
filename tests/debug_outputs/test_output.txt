==========================================
Pangolin CLI Live Test
==========================================

[0;34m===> Step 1: Login as Root Admin[0m
âœ… Logged in successfully as admin
[0;32mâœ“ Root admin logged in[0m
[0;34m===> Step 2: Creating Tenants[0m
âœ… Tenant 'tenant_alpha' created successfully.
âœ… Tenant 'tenant_beta' created successfully.
[0;32mâœ“ Created tenant_alpha and tenant_beta[0m
[0;34m===> Step 3: Setting up Tenant Alpha Infrastructure[0m
âœ… Logged in successfully as admin_alpha
âœ… Warehouse 'warehouse_alpha' created.
âœ… Catalog 'catalog_alpha' created.
[0;32mâœ“ Created warehouse_alpha and catalog_alpha[0m
[0;34m===> Step 4: Creating Users in Tenant Alpha[0m
âœ… User 'alice_alpha' created.
âœ… User 'bob_alpha' created.
[0;32mâœ“ Created alice_alpha and bob_alpha[0m
[0;34m===> Step 5: Granting Permissions to Alice[0m
âœ… Permission granted to user 'alice_alpha' on 'catalog:catalog_alpha'
[0;32mâœ“ Granted read/write/branching permissions to alice_alpha on catalog_alpha[0m
[0;34m===> Step 6: Setting up Tenant Beta Infrastructure[0m
âœ… Logged in successfully as admin_beta
âœ… Warehouse 'warehouse_beta' created.
âœ… Catalog 'catalog_beta' created.
[0;32mâœ“ Created warehouse_beta and catalog_beta[0m
[0;34m===> Step 7: Testing Token Generation[0m
[1;33mâ„¹ Logging in as alice_alpha...[0m
DEBUG: Login Output: âœ… Logged in successfully as alice_alpha
[0;32mâœ“ Token generated successfully[0m
[1;33mâ„¹ Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI0Y...[0m
DEBUG: Token Payload:
{"sub":"4b8bdc0f-38b1-4148-af1a-5221f0981584","jti":"c5f46b13-d459-4abf-9535-fd8bdf91df85","username":"alice_alpha","tenant_id":"8d56f591-1e98-484d-97c2-fa158265a209","role":"tenant-user","exp":1768659574,"iat":1766067574}
[0;34m===> Step 8: Testing Federated Catalog Creation[0m
[1;33mâ„¹ Generating token for admin_beta...[0m
âœ… Logged in successfully as admin_beta
DEBUG: beta token output: 
âœ… Token generated successfully!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJlNGUzODY0NC0yYzExLTRiOGEtOGM2Mi01ZWFjNmU1YjFiNWMiLCJqdGkiOiI5Yzk2ODc0Ny0yZjE2LTRiOGUtODRmYi1lYjE5OTA3NTRiNzkiLCJ1c2VybmFtZSI6ImFkbWluX2JldGEiLCJ0ZW5hbnRfaWQiOiI5ZmVhZTkwMy04NjcwLTRiNmMtOTk5Yi0zYmVhMWRmZTUzYmEiLCJyb2xlIjoidGVuYW50LWFkbWluIiwiZXhwIjoxNzY4NjU5NTc1LCJpYXQiOjE3NjYwNjc1NzV9.K7N6y89E2t3ht8XjpWZQMQDb72FNv2xNkZiBNA7heus
Expires: 2026-01-17T14:19:35+00:00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸  Save this token securely. It will not be shown again.
ğŸ’¡ Use this token with PyIceberg:
   catalog = load_catalog('my_catalog', uri='...', token='<TOKEN>')
[1;33mâ„¹ Generated Beta Token: eyJ0eXAiOi...[0m
[1;33mâ„¹ Switching back to admin_alpha...[0m
âœ… Logged in successfully as admin_alpha
âœ… Federated catalog 'fed_catalog_beta' created successfully!
   Base URL: http://localhost:8080/v1/catalog_beta
   Auth Type: BearerToken
[0;32mâœ“ Created federated catalog fed_catalog_beta[0m
[0;34m===> Step 9: Testing Federated Catalog Operations[0m
+------------------+---------------------------------------+-------------+
| Name             | Base URL                              | Auth Type   |
+------------------+---------------------------------------+-------------+
| fed_catalog_beta | http://localhost:8080/v1/catalog_beta | BearerToken |
+------------------+---------------------------------------+-------------+
Testing connection to federated catalog 'fed_catalog_beta'...

1. Checking catalog configuration... âœ…
2. Testing namespace listing... âœ…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… Federated catalog 'fed_catalog_beta' is working correctly!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Namespaces accessible: []
[0;32mâœ“ Federated catalog test completed[0m
[0;34m===> Step 10: Testing Enhanced Branching[0m
âœ… Logged in successfully as alice_alpha
âœ… Branch 'feature-branch-1' created.
   Type: feature
[1;33mâ„¹ Creating experiment branch (partial branching will be tested after table creation)[0m
+------------------+-------------+
| Name             | Head Commit |
+------------------+-------------+
| feature-branch-1 | -           |
+------------------+-------------+
[0;32mâœ“ Enhanced branching tested[0m
[0;34m===> Step 11: Creating PyIceberg Test Script[0m
[0;32mâœ“ PyIceberg test script created[0m
[0;34m===> Step 12: Running PyIceberg Integration Test[0m
âœ“ Connected to catalog_alpha
âœ“ Created namespace test_ns
âœ“ Created table test_ns.test_table
âœ“ Wrote data to table
âœ“ Read 3 rows from table
pyarrow.Table
id: int64
name: string
----
id: [[1,2,3]]
name: [["Alice","Bob","Charlie"]]

âœ… All PyIceberg operations successful!
[0;32mâœ“ PyIceberg integration test passed[0m
[0;34m===> Step 13: Testing Partial Branching[0m
âœ… Branch 'experiment-branch-1' created.
   Type: experiment
   Assets: test_table
[0;32mâœ“ Partial branching tested[0m
[0;34m===> Step 14: Testing Permission Management[0m
âœ… Logged in successfully as admin_alpha
Error: API Request Failed: Error: 405 Method Not Allowed
