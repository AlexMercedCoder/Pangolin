2025-12-22 20:18:29,685 - INFO - Starting Integration Test for Backend: PostgresStore
2025-12-22 20:18:29,686 - INFO - Creating Tenant: 16a25c68-099a-4656-8260-01be9e4f87f1
2025-12-22 20:18:29,707 - INFO - Created Tenant ID: 41698cf7-f4b3-42d2-ad0f-c9c9787f280f
2025-12-22 20:18:29,707 - INFO - Creating Tenant Admin User
2025-12-22 20:18:30,693 - INFO - Logging in as Tenant Admin
2025-12-22 20:18:31,628 - INFO - Creating Warehouse with Vending Strategy
2025-12-22 20:18:31,654 - INFO - Creating Catalogs
2025-12-22 20:18:31,723 - INFO - >>> Testing Vended Credentials Catalog (cat_vended)
2025-12-22 20:18:31,764 - INFO - Creating Namespace 'ns1'
2025-12-22 20:18:31,794 - INFO - Creating Table 'ns1.table1'
2025-12-22 20:18:31,826 - INFO - Table might exist, loading...
2025-12-22 20:18:31,846 - ERROR - ❌ Vended Credentials Test FAILED: RESTError 500: Received unexpected JSON Payload: Failed to read metadata file, errors: Invalid JSON: expected value at line 1 column 1
Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 525, in _create_table
    response.raise_for_status()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8080/v1/cat_vended/v1/namespaces/ns1/tables

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 164, in test_pyiceberg_vended
    table = catalog.create_table("ns1.table1", schema)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 540, in create_table
    table_response = self._create_table(
                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 527, in _create_table
    _handle_non_200_response(exc, {409: TableAlreadyExistsError, 404: NoSuchNamespaceError})
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/response.py", line 111, in _handle_non_200_response
    raise exception(response) from exc
pyiceberg.exceptions.ServerError: RESTError 500: Received unexpected JSON Payload: Failed to write metadata, errors: Invalid JSON: expected value at line 1 column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 629, in load_table
    response.raise_for_status()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8080/v1/cat_vended/v1/namespaces/ns1/tables/table1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 168, in test_pyiceberg_vended
    table = catalog.load_table("ns1.table1")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 631, in load_table
    _handle_non_200_response(exc, {404: NoSuchTableError})
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/response.py", line 111, in _handle_non_200_response
    raise exception(response) from exc
pyiceberg.exceptions.ServerError: RESTError 500: Received unexpected JSON Payload: Failed to read metadata file, errors: Invalid JSON: expected value at line 1 column 1
2025-12-22 20:18:31,849 - INFO - >>> Testing Client Credentials Catalog (cat_client)
2025-12-22 20:18:31,852 - INFO - Creating Namespace 'ns1'
2025-12-22 20:18:31,882 - INFO - Creating Table 'ns1.table1'
2025-12-22 20:18:31,924 - ERROR - ❌ Client Credentials Test FAILED: RESTError 500: Received unexpected JSON Payload: Failed to read metadata file, errors: Invalid JSON: expected value at line 1 column 1
Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 525, in _create_table
    response.raise_for_status()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8080/v1/cat_client/v1/namespaces/ns1/tables

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 225, in test_pyiceberg_client
    table = catalog.create_table("ns1.table1", schema)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 540, in create_table
    table_response = self._create_table(
                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 527, in _create_table
    _handle_non_200_response(exc, {409: TableAlreadyExistsError, 404: NoSuchNamespaceError})
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/response.py", line 111, in _handle_non_200_response
    raise exception(response) from exc
pyiceberg.exceptions.ServerError: RESTError 500: Received unexpected JSON Payload: Failed to write metadata, errors: Invalid JSON: expected value at line 1 column 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 629, in load_table
    response.raise_for_status()
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8080/v1/cat_client/v1/namespaces/ns1/tables/table1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/alexmerced/development/personal/Personal/2026/pangolin/tests/integration/test_pyiceberg_matrix.py", line 227, in test_pyiceberg_client
    table = catalog.load_table("ns1.table1")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/__init__.py", line 631, in load_table
    _handle_non_200_response(exc, {404: NoSuchTableError})
  File "/home/alexmerced/.pyenv/versions/3.11.2/lib/python3.11/site-packages/pyiceberg/catalog/rest/response.py", line 111, in _handle_non_200_response
    raise exception(response) from exc
pyiceberg.exceptions.ServerError: RESTError 500: Received unexpected JSON Payload: Failed to read metadata file, errors: Invalid JSON: expected value at line 1 column 1
2025-12-22 20:18:31,926 - ERROR - Tests FAILED
